var t,e=new Uint8Array(16);function n(){if(!t&&!(t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return t(e)}var o=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var s=function(t){return"string"==typeof t&&o.test(t)},r=[],i=0;i<256;++i)r.push((i+256).toString(16).substr(1));var a=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(r[t[e+0]]+r[t[e+1]]+r[t[e+2]]+r[t[e+3]]+"-"+r[t[e+4]]+r[t[e+5]]+"-"+r[t[e+6]]+r[t[e+7]]+"-"+r[t[e+8]]+r[t[e+9]]+"-"+r[t[e+10]]+r[t[e+11]]+r[t[e+12]]+r[t[e+13]]+r[t[e+14]]+r[t[e+15]]).toLowerCase();if(!s(n))throw TypeError("Stringified UUID is invalid");return n};var d=function(t,e,o){var s=(t=t||{}).random||(t.rng||n)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e){o=o||0;for(var r=0;r<16;++r)e[o+r]=s[r];return e}return a(s)};class c{constructor(t,e,n){this.startCode="Space",this.reactCode="Space",this.state="idle",this.measures=[],this.onTouchStart=t=>{if(console.log("touch",t),"running"!==this.state){const t=new KeyboardEvent("keypress",{code:this.startCode});return void document.dispatchEvent(t)}const e=new KeyboardEvent("keydown",{code:this.startCode});document.dispatchEvent(e)},this.onKeypress=t=>{if(console.log(`keypress ${this.state}`,t,this),t.code===this.startCode)switch(this.state){case"idle":return this.state="starting",void this.round();case"starting":return void(this.state="canceling");case"roundend":return void this.reset();case"running":case"canceling":return}},this.onKeydown=t=>{"running"===this.state&&t.code===this.reactCode&&this.endRound()},this.div=t,this.history=e,this.html=n,this.state="idle"}async round(){const t="(Press <kbd>Space</kbd> to cancel)";this.div.innerHTML="<b>3</b> "+t;for(let e=3e3;e-=10;){if("canceling"===this.state)return void this.reset();2e3===e&&(this.div.innerHTML="<b>2</b> "+t),1e3===e&&(this.div.innerHTML="<b>1</b> "+t),await u(10)}const e=Math.floor(3e3*Math.random())+750;this.div.textContent="WAIT",document.addEventListener("keypress",(()=>{this.endRound()}),{once:!0}),console.log("popping ",e),setTimeout((()=>this.flip()),e),console.log(this.div)}flip(){console.log(this),console.log(this.div),this.state="flipped",this.html.classList.toggle("blam"),window.performance.mark("round-start"),this.div.innerHTML="<b>PRESS NOW!</b>"}endRound(){if("flipped"!==this.state)return this.state="roundend",window.performance.mark("round-end"),void(this.div.innerHTML="<b>TOO EARLY!</b> Press <kbd>Space</kbd> to reset.");window.performance.mark("round-end"),this.state="roundend",window.performance.measure("last-game","round-start","round-end"),window.performance.measure("round-"+d(),"round-start","round-end");const t=window.performance.getEntriesByName("last-game");this.div.textContent=t[0].duration.toPrecision(3),console.log(t[0].toJSON())}reset(){const t=window.performance.getEntriesByName("last-game"),e=document.createElement("li");0!==t.length&&(e.textContent=t[0].duration.toPrecision(3),this.history.appendChild(e)),this.html.classList.remove("blam"),this.state="idle",this.div.style.backgroundColor="white",performance.clearMarks(),performance.clearMeasures("last-game"),this.div.innerHTML="Press <kbd>Space</kbd> to start the round."}}async function u(t){return new Promise((e=>{setTimeout(e,t)}))}!function(){const t=new c(document.querySelector("div#game"),document.querySelector("ul#history"),document.querySelector("html"));document.addEventListener("keypress",t.onKeypress),document.addEventListener("touchstart",t.onTouchStart),document.addEventListener("keydown",t.onKeydown)}();